# ============================================================
# mosquitto.conf - Broker MQTT Seguro para Fábrica IoT
# ============================================================

# Puerto estándar MQTT sobre TLS
listener 8883

# Certificados del servidor
cafile /mosquitto/certs/ca.crt
certfile /mosquitto/certs/server.crt
keyfile /mosquitto/certs/server.key

# Exigir certificado de cliente (mutual TLS)
require_certificate true

# Usar el CN del certificado como nombre de usuario
# Esto permite que el ACL identifique al cliente por su CN
use_identity_as_username true

# Fichero de control de acceso
acl_file /mosquitto/config/acl.conf

# No permitir conexiones anónimas
allow_anonymous false

# Logs
log_type all
log_dest stdout
